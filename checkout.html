<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ | Ø±ÙŠØ§Ø­ÙŠÙ†</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  margin: 0;
}
.container {
  max-width: 520px;
  margin: 20px auto;
  background: #fff;
  padding: 20px;
  border-radius: 14px;
}
h2 { text-align: center; }
label { font-weight: bold; margin-top: 12px; display: block; }
.req { color: red; }
input, textarea {
  width: 100%;
  padding: 12px;
  margin-top: 6px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 15px;
}
.summary {
  background: #f1f1f1;
  padding: 15px;
  border-radius: 10px;
  margin-top: 15px;
}
button {
  width: 100%;
  padding: 14px;
  margin-top: 15px;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  cursor: pointer;
}
.whatsapp { background: #25D366; color: #fff; }
.maps { background: #4285F4; color: #fff; }
.payment-box { display: flex; gap: 10px; margin-top: 10px; }
.payment-box button {
  flex: 1;
  background: #eee;
}
.payment-box button.active {
  background: #b17c33;
  color: #fff;
}
.note { font-size: 13px; color: #555; text-align: center; }
.instapay { display:none; margin-top:10px; background:#f9f9f9; padding:10px; border-radius:8px; }
</style>
</head>

<body>

<div class="container">
<h2>ğŸ›’ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h2>

<label>Ø§Ù„Ø§Ø³Ù… <span class="req">*</span></label>
<input id="name" required>

<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ <span class="req">*</span></label>
<input id="phone" required>

<label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† <span class="req">*</span></label>
<textarea id="address" rows="2" required></textarea>

<button class="maps" onclick="openMaps()">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Google Maps</button>

<label>ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ <span class="req">*</span></label>
<div class="payment-box">
  <button onclick="selectPayment('ÙƒØ§Ø´')">ÙƒØ§Ø´</button>
  <button onclick="selectPayment('Instapay')">Instapay</button>
</div>

<!-- <div class="instapay" id="instapayBox">
  Ø±Ù‚Ù… Instapay: <b>01207772789</b>
</div>
-->
<label>ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„ØªÙˆØµÙŠÙ„</label>
<textarea id="notes" rows="2" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø§ØªØµØ§Ù„ Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„"></textarea>

<div class="summary">
  <b>ğŸ“¦ Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨:</b>
  <div id="summary"></div>
  <hr>
  <b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</b> <span id="total">0</span> Ø¬Ù†ÙŠÙ‡
</div>

<button class="whatsapp" onclick="sendOrder()">ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>

<p class="note">Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ… ÙˆÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ğŸŒ™âœ¨</p>
</div>

<script>
const cart = JSON.parse(localStorage.getItem("cart")) || [];
let paymentMethod = "";

const summaryEl = document.getElementById("summary");
const totalEl = document.getElementById("total");

let total = 0;

if (cart.length === 0) {
  summaryEl.innerHTML = "âŒ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©";
} else {
  cart.forEach(item => {
    let itemTotal = item.unit
      ? item.price * item.quantity
      : (item.price * item.quantity) / 1000;

    total += itemTotal;

    summaryEl.innerHTML += `
      <div>â€¢ ${item.product} Ã— ${item.quantity} ${item.unit || "Ø¬Ø±Ø§Ù…"}
      = ${itemTotal.toFixed(2)} Ø¬Ù†ÙŠÙ‡</div>`;
  });
}

totalEl.textContent = total.toFixed(2);

function selectPayment(type) {
  paymentMethod = type;
  document.querySelectorAll(".payment-box button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  document.getElementById("instapayBox").style.display =
    type === "Instapay" ? "block" : "none";
}

function openMaps() {
  window.open("https://www.google.com/maps", "_blank");
}

function sendOrder() {
  if (cart.length === 0) {
    alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");
    return;
  }

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const address = document.getElementById("address").value.trim();
  const notes = document.getElementById("notes").value.trim();

  if (!name || !phone || !address || !paymentMethod) {
    alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©");
    return;
  }

  let message = `ğŸŒ™ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ø­Ù…ØµÙ‡ Ø±ÙŠØ§Ø­ÙŠÙ† ğŸŒ™\n\n`;
  message += `Ø§Ù„Ø§Ø³Ù…: ${name}\n`;
  message += `Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\n`;
  message += `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}\n`;
  message += `Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: ${paymentMethod}\n\n`;
  message += `ğŸ“¦ Ø§Ù„Ø·Ù„Ø¨:\n`;

  cart.forEach(item => {
    let price = item.unit
      ? item.price * item.quantity
      : (item.price * item.quantity) / 1000;

    message += `- ${item.product} Ã— ${item.quantity} = ${price.toFixed(2)} Ø¬Ù†ÙŠÙ‡\n`;
  });

  message += `\nğŸ’µ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toFixed(2)} Ø¬Ù†ÙŠÙ‡\n`;
  if (notes) message += `ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${notes}\n`;
  message += `\nØ´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ… ÙˆÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ğŸŒ™âœ¨`;

  const url = `https://wa.me/201207772789?text=${encodeURIComponent(message)}`;
  window.open(url, "_blank");

  fetch("https://script.google.com/macros/s/AKfycbzCybPEI_7__NgAcQcG0O0mzGs4wGNAPAFezf7Bn5KmvEHHBhbODMI2qdjdwmeQaxYc/exec", {
    method: "POST",
    body: JSON.stringify({
      name, phone, address,
      payment: paymentMethod,
      order: message,
      total: total.toFixed(2)
    })
  });
}
</script>

</body>
</html>
