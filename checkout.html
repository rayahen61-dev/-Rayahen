<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</title>

<style>
body{
  font-family: Arial;
  background:#f7f7f7;
}
.container{
  max-width:500px;
  margin:30px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
}
label{font-weight:bold;margin-top:10px;display:block}
input,textarea{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:8px;
  border:1px solid #ccc;
}
input.error, textarea.error{
  border:2px solid red;
}
.summary{
  background:#f1f1f1;
  padding:10px;
  border-radius:8px;
  margin-top:15px;
}
.btn{
  width:100%;
  padding:15px;
  background:#25D366;
  color:#fff;
  border:none;
  border-radius:10px;
  font-size:16px;
  margin-top:20px;
  cursor:pointer;
}
.payment-box{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.payment-btn{
  flex:1;
  padding:12px;
  border:1px solid #ccc;
  border-radius:8px;
  text-align:center;
  cursor:pointer;
}
.payment-btn.active{
  background:#25D366;
  color:#fff;
  border-color:#25D366;
}
.note{
  color:red;
  font-size:13px;
  margin-top:8px;
  display:none;
}
</style>
</head>

<body>

<div class="container">
<h2>ğŸ›’ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h2>

<label>Ø§Ù„Ø§Ø³Ù… *</label>
<input id="name">

<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
<input id="phone" inputmode="numeric">

<label>Ø§Ù„Ø­ÙŠ *</label>
<input id="district">

<label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
<input id="area">

<label>Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ø±Ø¹ *</label>
<input id="street">

<label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰ *</label>
<input id="building">

<label>Ø§Ù„Ø¯ÙˆØ± *</label>
<input id="floor">

<label>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø© *</label>
<input id="apartment">

<label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ *</label>
<textarea id="address" rows="3"></textarea>

<label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ *</label>
<div class="payment-box">
  <div class="payment-btn" onclick="selectPayment('ÙƒØ§Ø´', this)">ğŸ’µ ÙƒØ§Ø´</div>
  <div class="payment-btn" onclick="selectPayment('Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ', this)">ğŸ’³ Instapay</div>
</div>

<div id="instaNote" class="note">
Ø¨Ø±Ø¬Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ ğŸ“¸
</div>

<label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
<textarea id="notes" rows="2"></textarea>

<div class="summary">
<strong>ğŸ“¦ Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨:</strong>
<div id="orderSummary"></div>
<hr>
<strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> <span id="totalPrice">0</span> Ø¬Ù†ÙŠÙ‡
</div>

<button class="btn" onclick="sendOrder()">ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨</button>
</div>

<script>
/* ================= Ø§Ù„Ø³Ù„Ø© ================= */
const cart = JSON.parse(localStorage.getItem("cart")) || [];
const summary = document.getElementById("orderSummary");
const totalEl = document.getElementById("totalPrice");

let total = 0;
summary.innerHTML = "";

cart.forEach(item=>{
  const itemTotal = item.unit
    ? item.price * item.quantity
    : (item.price * item.quantity) / 1000;

  total += itemTotal;

  summary.innerHTML += `
    <div>
      ${item.product} Ã— ${item.quantity} ${item.unit || "Ø¬Ø±Ø§Ù…"}
      = ${itemTotal.toFixed(2)} Ø¬Ù†ÙŠÙ‡
    </div>
  `;
});

totalEl.textContent = total.toFixed(2);

/* ================= Ø§Ù„Ø¯ÙØ¹ ================= */
let paymentMethod = "";

function selectPayment(method, el){
  paymentMethod = method;
  document.querySelectorAll(".payment-btn").forEach(b=>b.classList.remove("active"));
  el.classList.add("active");
  document.getElementById("instaNote").style.display =
    method === "Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ" ? "block" : "none";
}

/* ================= Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ================= */
function sendOrder(){
  const ids = [
    "name","phone","district","area","street",
    "building","floor","apartment","address"
  ];

  let valid = true;
  ids.forEach(id=>{
    const el = document.getElementById(id);
    el.classList.remove("error");
    if(!el.value.trim()){
      el.classList.add("error");
      valid = false;
    }
  });

  const phone = document.getElementById("phone").value.trim();
  if(!/^\d{11}$/.test(phone)){
    document.getElementById("phone").classList.add("error");
    alert("Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…");
    return;
  }

  if(!paymentMethod){
    alert("Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹");
    return;
  }

  if(!valid){
    alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©");
    return;
  }

  /* ===== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===== */
  const nameVal = document.getElementById("name").value.trim();
  const districtVal = document.getElementById("district").value.trim();
  const areaVal = document.getElementById("area").value.trim();
  const streetVal = document.getElementById("street").value.trim();
  const buildingVal = document.getElementById("building").value.trim();
  const floorVal = document.getElementById("floor").value.trim();
  const apartmentVal = document.getElementById("apartment").value.trim();
  const addressVal = document.getElementById("address").value.trim();
  const notesVal = document.getElementById("notes").value.trim();

  /* ===== Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ ===== */
  let message = `ğŸŒ™ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ø­Ù…ØµØ© Ø±ÙŠØ§Ø­ÙŠÙ† ğŸŒ™\n\n`;
  message += `Ø§Ù„Ø§Ø³Ù…: ${nameVal}\n`;
  message += `Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\n`;
  message += `Ø§Ù„Ø­ÙŠ: ${districtVal}\n`;
  message += `Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${areaVal}\n`;
  message += `Ø§Ù„Ø´Ø§Ø±Ø¹: ${streetVal}\n`;
  message += `Ø§Ù„Ù…Ø¨Ù†Ù‰: ${buildingVal}\n`;
  message += `Ø§Ù„Ø¯ÙˆØ±: ${floorVal}\n`;
  message += `Ø§Ù„Ø´Ù‚Ø©: ${apartmentVal}\n`;
  message += `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${addressVal}\n`;
  message += `Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: ${paymentMethod}\n\nğŸ“¦ Ø§Ù„Ø·Ù„Ø¨:\n`;

  cart.forEach(item=>{
    const itemTotal = item.unit
      ? item.price * item.quantity
      : (item.price * item.quantity)/1000;
    message += `- ${item.product} Ã— ${item.quantity} = ${itemTotal.toFixed(2)} Ø¬Ù†ÙŠÙ‡\n`;
  });

  message += `\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
  if(notesVal) message += `\nğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${notesVal}`;
  message += `\n\nØ´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ… ÙˆÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ğŸŒ™âœ¨`;

  /* ===== Google Sheet ===== */
  fetch("https://script.google.com/macros/s/AKfycbyb6Qzn9yWoyRnGiQMbQWO8F5n2gTW7Q0DupDcxfqx2_xfz6A6R9l97VkULqrIVyu5M/exec",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      name: nameVal,
      phone,
      district: districtVal,
      area: areaVal,
      street: streetVal,
      building: buildingVal,
      floor: floorVal,
      apartment: apartmentVal,
      payment: paymentMethod,
      notes: notesVal,
      order: JSON.stringify(cart),
      total
    })
  });

  /* ===== WhatsApp ===== */
  window.open(
    `https://wa.me/201207772789?text=${encodeURIComponent(message)}`,
    "_blank"
  );
}
</script>

</body>
</html>
